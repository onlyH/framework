实现发布订阅模式：

- 首先指定好谁充当发布者（售楼处）
- 然后给发布者添加一个缓存列表，用语存放回调函数，以便通知订阅者（售楼处花名册）。
- 最后发布消息的时候，发布者会遍历这个缓存列表，依次触发里面存放的订阅者的回调函数。

 Vue 有个最显著的特性，便是侵入性不是很强的响应式系统
 
 ![33](https://segmentfault.com/img/remote/1460000013338807?w=600&h=382)
 
 
 
 
 _____________________________________________________________________________________________________________________________________
 ![](https://pic2.zhimg.com/80/v2-872e915d9158aaf9ff167b5f387e359d_720w.jpg)
 数据从2号传到4号，就得经过7号，10号，再从10号传到8号，再传到4号，过程非常复杂，代码也显得非常臃肿，难以维护。显然仅仅用单向数据流或者双向绑定，并不能很好的满足我们的开发要求。
 
 全新的开发模式，发布-订阅模式，它是基于Vue的$on,$off,$emit这三个API开发。原理是创建一个事件中心绑定到每个组件上面，只要有一个组件的有新的数据发布到上面，其他已经订阅的组件就可以同步获取。
 
 --------------------------------------------------------------------------------------------------------------------------------------------
 双向数据绑定无非就是在单向绑定的基础上给可输入元素（input、textare等）添加了change(input)事件，来动态修改model和 view
 
 实现数据绑定的做法有大致如下几种：
 
> 发布者-订阅者模式（backbone.js）

> 脏值检查（angular.js）

> 数据劫持（vue.js）
 ________________________________________________________________________________________________________________________________________
 双向数据绑定指的是将对象属性变化绑定到UI，或者反之。换句话说，如果我们有一个拥有name属性的user对象，当我们给user.name赋予一个新值是UI也会相应的显示新的名字。同样的，如果UI包括了一个输入字段用来输入用户名，输入一个新的值会导致user对象中的那么属性发生变化

发布者-订阅者模式: 一般通过sub, pub的方式实现数据和视图的绑定监听，更新数据方式通常做法是 vm.set('property', value)

更希望通过 vm.property = value这种方式更新数据，同时自动更新视图，于是有了下面两种方式

脏值检查: 最简单的方式就是通过 setInterval() 定时轮询检测数据变动,angular只有在指定的事件触发时进入脏值检测，大致如下：

DOM事件，譬如用户输入文本，点击按钮等。( ng-click ) 

XHR响应事件 ( $http )

浏览器Location变更事件 ( $location )

Timer事件( timeout ,interval )

执行 digest() 或apply()


数据劫持: vue.js 则是采用数据劫持结合发布者-订阅者模式的方式，通过Object.defineProperty()来劫持各个属性的setter，getter，在数据变动时发布消息给订阅者，触发相应的监听回调。

要实现mvvm的双向绑定，就必须要实现以下几点：

1、实现一个数据监听器Observer，能够对数据对象的所有属性进行监听，如有变动可拿到最新值并通知订阅者

2、实现一个指令解析器Compile，对每个元素节点的指令进行扫描和解析，根据指令模板替换数据，以及绑定相应的更新函数

3、实现一个Watcher，作为连接Observer和Compile的桥梁，能够订阅并收到每个属性变动的通知，执行指令绑定的相应回调函数，从而更新视图

4、mvvm入口函数，整合以上三者

![](https://user-gold-cdn.xitu.io/2020/6/9/172970655167cff7?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)






